<!DOCTYPE html>
<html>
<head>
  <title>Mini Comet</title>
  <style>
    /* Basic Layout & Theme */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: #f0f2f5;
      color: #1c1e21;
      margin: 0;
      padding: 16px;
      font-size: 14px;
      min-width: 300px;
    }
    h2 {
      font-size: 16px;
      color: #050505;
      border-bottom: 1px solid #dddfe2;
      padding-bottom: 8px;
      margin-top: 0;
    }
    /* Summary Section: now a <div> to render HTML */
    #summary {
      white-space: pre-wrap;
      word-wrap: break-word;
      background-color: #ffffff;
      border: 1px solid #dddfe2;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
      min-height: 40px;
    }
    
    /* Chat Section */
    #chat-box {
      background-color: #ffffff;
      border: 1px solid #dddfe2;
      border-radius: 8px;
      padding: 12px;
      height: 250px;
      overflow-y: auto;
      margin-bottom: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .chat-message {
      padding: 8px 12px;
      border-radius: 18px;
      max-width: 85%;
      word-wrap: break-word;
      line-height: 1.4;
    }

    /* FIX: User message aligns to the right */
    .user-message {
      background-color: #0084ff;
      color: white;
      align-self: flex-end; /* Aligns the message bubble to the right */
      text-align: left; /* Text inside the bubble is left-aligned */
    }

    /* FIX: AI message aligns to the left */
    .ai-message {
      background-color: #e4e6eb;
      color: #050505;
      align-self: flex-start; /* Aligns the message bubble to the left */
      text-align: left;
    }

    /* Input Form */
    #chat-form {
      display: flex;
      gap: 8px;
    }

    #prompt {
      flex-grow: 1;
      border: 1px solid #ccd0d5;
      border-radius: 18px;
      padding: 8px 14px;
      font-size: 14px;
      outline: none;
    }

    #prompt:focus {
      border-color: #0084ff;
    }

    button[type="submit"] {
      background-color: #0084ff;
      color: white;
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 24px;
      line-height: 36px; /* Helps center the character vertically */
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s;
      flex-shrink: 0;
    }

    button[type="submit"]:hover {
      background-color: #0073e0;
    }
    
    /* Loader Animation */
    .loader {
      display: none; /* Hidden by default */
      text-align: center;
      padding: 10px;
    }

    .thinking-dots {
      display: inline-block;
      position: relative;
      width: 60px;
      height: 15px;
    }

    .thinking-dots div {
      position: absolute;
      top: 5px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #0084ff;
      animation-timing-function: cubic-bezier(0, 1, 1, 0);
    }

    .thinking-dots div:nth-child(1) { left: 6px; animation: thinking-dots1 0.6s infinite; }
    .thinking-dots div:nth-child(2) { left: 6px; animation: thinking-dots2 0.6s infinite; }
    .thinking-dots div:nth-child(3) { left: 26px; animation: thinking-dots2 0.6s infinite; }
    .thinking-dots div:nth-child(4) { left: 45px; animation: thinking-dots3 0.6s infinite; }

    @keyframes thinking-dots1 { 0% { transform: scale(0); } 100% { transform: scale(1); } }
    @keyframes thinking-dots3 { 0% { transform: scale(1); } 100% { transform: scale(0); } }
    @keyframes thinking-dots2 { 0% { transform: translate(0, 0); } 100% { transform: translate(19px, 0); } }
  </style>
</head>
<body>

  <h2>Webpage Summary</h2>
  <div id="summary-container">
    <div class="loader" id="summary-loader">
        <div class="thinking-dots"><div></div><div></div><div></div><div></div></div>
    </div>
    <div id="summary"></div>
  </div>

  <hr style="border: none; border-top: 1px solid #dddfe2; margin: 20px 0;">

  <h2>Chat about this page</h2>
  <div id="chat-box"></div>
  <div class="loader" id="chat-loader">
    <div class="thinking-dots"><div></div><div></div><div></div><div></div></div>
  </div>

  <form id="chat-form">
    <input type="text" id="prompt" placeholder="Ask anything..." autocomplete="off"/>
    <button type="submit" aria-label="Send">â€º</button>
  </form>

  <script src="sidepanel.js"></script>
</body>
</html>
